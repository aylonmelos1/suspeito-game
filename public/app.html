<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0b1021">
    <meta name="description" content="Bloco de notas para o jogo Suspeito">
    <title>Suspeito Game</title>

    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="icon-192.png">
</head>

<body>
    <div class="app-container">
        <!-- Header - Palpite Atual -->
        <header class="guess-header">
            <h2>Suspeito <span id="game-timer" class="game-timer" onclick="app.toggleTimer()">00:00</span></h2>
            <div class="guess-slots">
                <div class="guess-slot" data-type="suspeito" onclick="app.openSelectionModal('suspeitos')">
                    <span class="slot-label">Quem?</span>
                    <span class="slot-value" id="guess-suspeito">?</span>
                    <span class="slot-icon">üë§</span>
                </div>
                <div class="guess-slot" data-type="arma" onclick="app.openSelectionModal('arma')">
                    <span class="slot-label">Com o qu√™?</span>
                    <span class="slot-value" id="guess-arma">?</span>
                    <span class="slot-icon">üî´</span>
                </div>
                <div class="guess-slot" data-type="local" onclick="app.openSelectionModal('local')">
                    <span class="slot-label">Onde?</span>
                    <span class="slot-value" id="guess-local">?</span>
                    <span class="slot-icon">üìç</span>
                </div>
            </div>
        </header>

        <!-- Bot√£o Registrar Palpite -->
        <button class="guess-register-btn" onclick="app.openGuessModal()">
            <span class="icon">üìù</span> Registrar Palpite
        </button>

        <!-- Listas de Itens -->
        <main id="game-lists">
            <!-- As listas ser√£o geradas via JS -->
            <section class="category-section" id="section-suspeitos">
                <h3>Suspeitos</h3>
                <div class="items-grid" id="list-suspeitos"></div>
            </section>

            <section class="category-section" id="section-armas">
                <h3>Armas</h3>
                <div class="items-grid" id="list-arma"></div>
            </section>

            <section class="category-section" id="section-locais">
                <h3>Locais</h3>
                <div class="items-grid" id="list-local"></div>
            </section>
        </main>

        <!-- Bot√£o Menu (Hamburger) -->
        <button class="sidebar-toggle-btn" id="sidebar-toggle" onclick="app.toggleSidebar()">
            <span class="hamburger-icon">
                <span></span><span></span><span></span>
            </span>
        </button>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-inner">
                <div class="sidebar-header">
                    <h3>Menu</h3>
                    <button class="sidebar-close" onclick="app.toggleSidebar()">‚úï</button>
                </div>

                <!-- Info da Sala -->
                <div class="sidebar-section hidden" id="room-info-section">
                    <h4>Sala</h4>
                    <div class="room-id-display">
                        <span class="room-id-label">ID da Sala</span>
                        <div class="room-id-value-wrapper">
                            <span class="room-id-value" id="room-id-value">‚Äî</span>
                            <button class="room-id-copy-btn" id="room-id-copy" onclick="app.copyRoomId()"
                                title="Copiar ID">üìã</button>
                        </div>
                    </div>
                </div>

                <!-- A√ß√µes -->
                <div class="sidebar-section">
                    <h4>A√ß√µes</h4>
                    <div class="sidebar-actions">
                        <button id="btn-leave" class="sidebar-btn danger hidden" onclick="app.leaveRoom()">
                            <span class="sidebar-btn-icon">üö™</span> Sair da Sala
                        </button>
                        <button class="sidebar-btn" onclick="app.clearMarks()">
                            <span class="sidebar-btn-icon">üßπ</span> Limpar Marca√ß√µes
                        </button>
                        <button id="btn-reset" class="sidebar-btn warning" onclick="app.resetGame()">
                            <span class="sidebar-btn-icon">üîÑ</span> Nova Partida
                        </button>
                        <button id="btn-update" class="sidebar-btn" onclick="app.checkForUpdates()">
                            <span class="sidebar-btn-icon">‚òÅÔ∏è</span> Buscar Atualiza√ß√µes
                        </button>
                    </div>
                </div>

                <!-- Log de Atividades -->
                <div class="sidebar-section">
                    <h4>Atividades</h4>
                    <div class="activity-log" id="activity-log">
                        <p class="activity-empty">Nenhuma atividade ainda...</p>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Modal de Palpite -->
        <div id="guess-modal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Registrar Palpite</h2>
                    <button class="close-btn" onclick="app.closeModal('guess-modal')">&times;</button>
                </div>
                <div class="modal-body">
                    <p style="margin-bottom: 1rem; color: var(--text-secondary);">Selecione os itens para compor seu
                        palpite:</p>

                    <div class="guess-inputs">
                        <div class="guess-input-group">
                            <label>Suspeito</label>
                            <button id="modal-guess-suspeito" class="guess-selector"
                                onclick="app.openGuessSelection('suspeito')">
                                Selecionar...
                            </button>
                        </div>
                        <div class="guess-input-group">
                            <label>Arma</label>
                            <button id="modal-guess-arma" class="guess-selector"
                                onclick="app.openGuessSelection('arma')">
                                Selecionar...
                            </button>
                        </div>
                        <div class="guess-input-group">
                            <label>Local</label>
                            <button id="modal-guess-local" class="guess-selector"
                                onclick="app.openGuessSelection('local')">
                                Selecionar...
                            </button>
                        </div>
                    </div>

                    <div class="modal-actions" style="margin-top: 1.5rem;">
                        <button class="action-btn secondary" onclick="app.submitGuess(false)">
                            üí¨ Palpite Normal (Suspeita)
                        </button>
                        <button class="action-btn warning" onclick="app.submitGuess(true)">
                            üèÜ Palpite Final (Acusa√ß√£o)
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Overlay da Sidebar -->
        <div class="sidebar-overlay" id="sidebar-overlay" onclick="app.toggleSidebar()"></div>

        <!-- Container de Notifica√ß√µes -->
        <div id="toast-container" class="toast-container"></div>

        <!-- Modal de Sele√ß√£o -->
        <div id="selection-modal" class="modal">
            <div class="modal-content">
                <h3 id="modal-title">Selecionar</h3>
                <div id="modal-list" class="modal-list"></div>
                <button class="modal-close" onclick="app.closeModal()">Fechar</button>
            </div>
        </div>

        <!-- Modal Customizado (Confirm / Alert) -->
        <div id="custom-modal-overlay" class="custom-modal-overlay">
            <div class="custom-modal-box">
                <p id="custom-modal-message" class="custom-modal-message"></p>
                <div class="custom-modal-buttons">
                    <button id="custom-modal-cancel" class="custom-modal-btn cancel">Cancelar</button>
                    <button id="custom-modal-confirm" class="custom-modal-btn confirm">Confirmar</button>
                </div>
            </div>
        </div>

        <script src="/socket.io/socket.io.js"></script>
        <script src="app.js?v=2"></script>
        <script>
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => {
                        console.log('SW registrado!', reg);
                        // For√ßar update imediato se houver nova vers√£o
                        reg.update();
                    })
                    .catch(err => console.error('Erro SW:', err));
            }
        </script>
</body>

</html>